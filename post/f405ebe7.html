<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>5.python基础自动画办公 | 醉卿枫の博客</title><meta name="author" content="醉卿枫"><meta name="copyright" content="醉卿枫"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="自动化办公文件读写开-open（） 绝对路径：绝对路径就是最完整的路径；将文件拖入VScode终端可以获得绝对路径 或者右键复制路劲 相对路径：指的就是【相对于当前文件夹】的路径 windows系统中\来表示绝对路径，&#x2F;表示相对路径 格式：文件名&#x3D;(‘路径’，’模式’，encoding&#x3D;’utf-8’) sumlime text3要绝对路径  1234open(&amp;#x">
<meta property="og:type" content="article">
<meta property="og:title" content="5.python基础自动画办公">
<meta property="og:url" content="https://github.com/wjl-a/data.github.io/post/f405ebe7.html">
<meta property="og:site_name" content="醉卿枫の博客">
<meta property="og:description" content="自动化办公文件读写开-open（） 绝对路径：绝对路径就是最完整的路径；将文件拖入VScode终端可以获得绝对路径 或者右键复制路劲 相对路径：指的就是【相对于当前文件夹】的路径 windows系统中\来表示绝对路径，&#x2F;表示相对路径 格式：文件名&#x3D;(‘路径’，’模式’，encoding&#x3D;’utf-8’) sumlime text3要绝对路径  1234open(&amp;#x">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bu.dusays.com/2022/05/29/62939662553c9.png">
<meta property="article:published_time" content="2022-04-03T13:05:00.000Z">
<meta property="article:modified_time" content="2023-12-01T13:27:50.593Z">
<meta property="article:author" content="醉卿枫">
<meta property="article:tag" content="python&#x2F;python语法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bu.dusays.com/2022/05/29/62939662553c9.png"><link rel="shortcut icon" href="/data.github.io/img/favicon.png"><link rel="canonical" href="https://github.com/wjl-a/data.github.io/post/f405ebe7.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/data.github.io/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/data.github.io/',
  algolia: undefined,
  localSearch: {"path":"/data.github.io/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '5.python基础自动画办公',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-01 21:27:50'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (true) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/12.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/data.github.io/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/data.github.io/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/data.github.io/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/data.github.io/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/data.github.io/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/data.github.io/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://bu.dusays.com/2022/05/29/62939662553c9.png')"><nav id="nav"><span id="blog-info"><a href="/data.github.io/" title="醉卿枫の博客"><span class="site-name">醉卿枫の博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/data.github.io/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/data.github.io/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/data.github.io/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/data.github.io/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">5.python基础自动画办公</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-03T13:05:00.000Z" title="发表于 2022-04-03 21:05:00">2022-04-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-12-01T13:27:50.593Z" title="更新于 2023-12-01 21:27:50">2023-12-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/data.github.io/categories/python%E5%9F%BA%E7%A1%80/">python基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="5.python基础自动画办公"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="自动化办公"><a href="#自动化办公" class="headerlink" title="自动化办公"></a>自动化办公</h1><h1 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h1><h2 id="开-open（）"><a href="#开-open（）" class="headerlink" title="开-open（）"></a>开-open（）</h2><ul>
<li>绝对路径：<strong>绝对路径</strong>就是最完整的路径；将文件拖入VScode终端可以获得绝对路径</li>
<li>或者右键复制路劲</li>
<li>相对路径：指的就是【相对于当前文件夹】的路径</li>
<li>windows系统中\来表示绝对路径，&#x2F;表示相对路径</li>
<li><strong>格式：文件名&#x3D;(‘路径’，’模式’，encoding&#x3D;’utf-8’)</strong></li>
<li>sumlime text3要绝对路径</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;C:\\Users\\Ted\\Desktop\\test\\abc.txt&#x27;</span>)</span><br><span class="line"><span class="comment">#将&#x27;\&#x27;替换成&#x27;\\&#x27;</span></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>)    <span class="comment">#相对路径</span></span><br><span class="line"><span class="comment">#相对路径也可以写成open(&#x27;./abc.txt&#x27;)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>‘r’:表示以读得模式打开文件</li>
</ul>
<h3 id="模式汇总"><a href="#模式汇总" class="headerlink" title="模式汇总"></a>模式汇总</h3><table>
<thead>
<tr>
<th>r(read，读)</th>
<th>r只读，指针在开头文件不存在则报错</th>
<th>rb二进制只读，其余同左</th>
<th>r+读写，其余同左</th>
<th>rb+二进制读写，其余同左</th>
</tr>
</thead>
<tbody><tr>
<td>w(write,写)</td>
<td>w只写，文件不存在则新建，存在则覆盖</td>
<td>wb二进制只写，其余同左</td>
<td>w+读写，其余同左</td>
<td>wb+二进制读写，其余同左</td>
</tr>
<tr>
<td>a(append,追加)</td>
<td>a追加,文件存在指针放在末尾,文件不存在则新建</td>
<td>ab二进制追加，其余同左</td>
<td>a+追加且可读,其余同左</td>
<td>ab+二进制追加，且可读，其余同左</td>
</tr>
</tbody></table>
<ul>
<li>**’wb’**的模式，它的意思是以二进制的方式打开一个文件用于写入。因为图片和音频是以二进制的形式保存的，所以使用wb模式就好了</li>
</ul>
<h2 id="读-read（）"><a href="#读-read（）" class="headerlink" title="读-read（）"></a>读-read（）</h2><h3 id="直接读取"><a href="#直接读取" class="headerlink" title="直接读取"></a>直接读取</h3><p><strong>变量名&#x3D;文件名.read()</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#变量名=文件名.read()</span></span><br><span class="line">file1 = <span class="built_in">open</span>(<span class="string">&#x27;/Users/Ted/Desktop/test/abc.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">filecontent = file1.read()      </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ile1=<span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#定义文件名</span></span><br><span class="line">file2=file1.read()<span class="comment">#读文件并复制给变量</span></span><br><span class="line"><span class="built_in">print</span>(file2)</span><br><span class="line">file1.close()<span class="comment">#关闭文件</span></span><br></pre></td></tr></table></figure>

<h3 id="按行读取"><a href="#按行读取" class="headerlink" title="按行读取"></a>按行读取</h3><p><strong>方式1</strong></p>
<ul>
<li>格式：<strong>变量名&#x3D;文件名.readlines()</strong></li>
<li><strong>readlines()</strong> 会从txt文件取得一个列表，列表中的每个字符串就是文件中的每一行。而且每个字符串后面还有换行的<code>\n</code>**符号。</li>
<li><strong>for循环</strong>来遍历这个列表</li>
</ul>
<p><strong>方式2</strong></p>
<ul>
<li>这种方式可以将csv中的表格数据以列表的形式保存，每行也是列表形式<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;score.csv&#x27;</span>, <span class="string">&quot;r&quot;</span>,encoding=<span class="string">&#x27;utf8&#x27;</span>,newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	reader = csv.reader(f)</span><br><span class="line">	<span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">		<span class="built_in">print</span>(row)<span class="comment">#按行读取并输出该行列表形式</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="写-write"><a href="#写-write" class="headerlink" title="写-write()"></a>写-write()</h2><h3 id="‘w’模式"><a href="#‘w’模式" class="headerlink" title="‘w’模式"></a>‘w’模式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file1=<span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">file1.write(<span class="string">&#x27;张无忌\n&#x27;</span>)</span><br><span class="line">file1.close()</span><br></pre></td></tr></table></figure>

<ul>
<li>‘w：表示写入文件’</li>
<li>参数为字符串</li>
<li>格式：<strong>文件名.write(‘内容’)</strong></li>
<li>**’w’写入模式会给你暴力清空掉文件</li>
<li>**write()**函数写入文本文件的也是字符串类型。</li>
<li>在**’w’<strong>和</strong>‘a’<strong>模式下，如果你打开的文件不存在，那么</strong>open()**函数会自动帮你创建一个</li>
</ul>
<h3 id="‘a’模式"><a href="#‘a’模式" class="headerlink" title="‘a’模式"></a>‘a’模式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file1 = <span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line"><span class="comment">#以追加的方式打开文件abc.txt</span></span><br><span class="line">file1.write(<span class="string">&#x27;张无忌\n&#x27;</span>)     </span><br><span class="line"><span class="comment">#把字符串&#x27;张无忌&#x27;写入文件file1</span></span><br><span class="line">file1.write(<span class="string">&#x27;宋青书\n&#x27;</span>)     </span><br><span class="line"><span class="comment">#把字符串&#x27;宋青书&#x27;写入文件file1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>追加模式：增加内容而不是覆盖原来的内容</li>
<li>如果不存在该文件，则会自动创建文件</li>
</ul>
<p>实例</p>
<ul>
<li>[[毕业设计#写入数据到csv表中|写入数据到csv表中]]</li>
</ul>
<h2 id="关-close"><a href="#关-close" class="headerlink" title="关-close()"></a>关-close()</h2><ul>
<li>关闭文件</li>
<li>计算机能够打开的文件数量是有限制的，open()过多而不close()的话，就不能再打开文件了。</li>
<li>能保证写入的内容已经在文件里被保存好了。</li>
<li><strong>文件名.close</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file1=<span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#定义文件名</span></span><br><span class="line">file2=file1.read()<span class="comment">#读文件并复制给变量</span></span><br><span class="line"><span class="built_in">print</span>(file2)</span><br><span class="line">file1.close()<span class="comment">#关闭文件</span></span><br></pre></td></tr></table></figure>

<h2 id="关键字with"><a href="#关键字with" class="headerlink" title="关键字with"></a>关键字with</h2><ul>
<li>为了避免打开文件后忘记关闭，占用资源或当不能确定关闭文件的恰当时机的时候，我们可以用到关键字with</li>
<li>格式：with open(‘文件地址’,’读写模式’) as 变量名:</li>
<li>后面编码：encoding&#x3D;’utf-8’：如果要文件包括中文要加</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 普通写法</span></span><br><span class="line">file1 = <span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">file1.write(<span class="string">&#x27;张无忌&#x27;</span>) </span><br><span class="line">file1.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用with关键字的写法</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;abc.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file1:</span><br><span class="line"><span class="comment">#with open(&#x27;文件地址&#x27;,&#x27;读写模式&#x27;,encoding=&#x27;utf-8&#x27;) as 变量名:</span></span><br><span class="line">    <span class="comment">#格式：冒号不能丢</span></span><br><span class="line">    file1.write(<span class="string">&#x27;张无忌&#x27;</span>) </span><br><span class="line">    <span class="comment">#格式：对文件的操作要缩进</span></span><br><span class="line">    <span class="comment">#格式：无需用close()关闭</span></span><br></pre></td></tr></table></figure>
<h2 id="split-分开字符串"><a href="#split-分开字符串" class="headerlink" title="split():分开字符串"></a>split():分开字符串</h2><ul>
<li>它会按空格把字符串里面的内容分开</li>
<li>最终组合成一个列表</li>
<li>格式：<strong>变量1&#x3D;变量2.split()</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">file1 = <span class="built_in">open</span>(<span class="string">&#x27;score.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">file_lines = file1.readlines()</span><br><span class="line">file1.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> file_lines:   <span class="comment">#用for...in...把每一行的数据遍历  </span></span><br><span class="line">    data =i.split()    <span class="comment">#把字符串切分成更细的一个个的字符串</span></span><br><span class="line">    <span class="built_in">print</span>(data)        <span class="comment">#打印出来看看</span></span><br><span class="line"></span><br><span class="line">string = <span class="string">&quot;abc abc\ndef\t&quot;</span></span><br><span class="line"><span class="built_in">print</span>(string.split())</span><br><span class="line">打印结果：[<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;def&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h1 id="csv模块"><a href="#csv模块" class="headerlink" title="csv模块"></a>csv模块</h1><ul>
<li><a target="_blank" rel="noopener" href="https://yiyibooks.cn/xx/python_352/library/csv.html#module-csv">官方文档</a>：看示例</li>
<li>注意;创建的excel文档是csv格式，另存</li>
</ul>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><p>-<code>#参数encoding</code>&#x3D; ‘utf-8’防止出现乱码；一般有中文要加;报错就删或者加</p>
<h3 id="读数据"><a href="#读数据" class="headerlink" title="读数据"></a>读数据</h3><h4 id="reader"><a href="#reader" class="headerlink" title="reader()"></a>reader()</h4><ul>
<li>读取的是列表格式</li>
<li>用于读取一般的csv文件</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\win10\\Desktop\\code\\.vscode\\python.csv&quot;</span>,newline = <span class="string">&#x27;&#x27;</span>)  <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="comment">#使用csv的reader()方法，创建一个reader对象</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader: </span><br><span class="line">    <span class="comment">#遍历reader对象的每一行</span></span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;读取完毕！&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>row：单元格所在行</li>
</ul>
<h5 id="相对路径说明"><a href="#相对路径说明" class="headerlink" title="相对路径说明"></a>相对路径说明</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">practice_wb = load_workbook(<span class="string">&#x27;./material/practice0.xlsx&#x27;</span>)<span class="comment">#material和py文件在同一目录文件夹，注意前面要加./代表同目录</span></span><br></pre></td></tr></table></figure>
<h4 id="DictReader类"><a href="#DictReader类" class="headerlink" title="DictReader类"></a>DictReader类</h4><ul>
<li><code>DictReader</code>类的操作类似于常规的<code>reader()</code>，但<code>DictReader</code>会将读取到的信息转换为字典形式</li>
<li>实例化<code>DictReader</code>类后，会得到一个<code>DictReader对象</code>，这是一个可迭代对象，我们可以使用循环来遍历它的每一个元素。但不同于<code>reader()</code>的是，该对象里面的每一个元素都是一个<strong>字典</strong>，每一个<strong>字典的值</strong>都可以对应csv文件中的一行，<strong>键</strong>对应csv文件的表头</li>
<li>属性<strong>fieldnames</strong>，该属性可以将csv文件（表格）的表头（第一行）读取出来，返回值是<strong>列表</strong>。这个<strong>表头也就是字典的键</strong>(key)。</li>
<li>通常读取第一行为表头的csv文件。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入csv模块</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 打开csv文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./DictReader_demo.csv&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> csv_file:</span><br><span class="line">    <span class="comment"># 将文件对象转换为DictReader对象</span></span><br><span class="line">    csv_reader = csv.DictReader(csv_file)</span><br><span class="line">    <span class="comment"># 获取表头</span></span><br><span class="line">    headers = csv_reader.fieldnames</span><br><span class="line">    <span class="comment"># 打印表头</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;表头：&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(headers))</span><br><span class="line">    <span class="comment"># 遍历DictReader对象</span></span><br><span class="line">    <span class="keyword">for</span> csv_row <span class="keyword">in</span> csv_reader:</span><br><span class="line">        <span class="comment"># 打印数据</span></span><br><span class="line">        <span class="built_in">print</span>(csv_row)</span><br></pre></td></tr></table></figure>
<h3 id="写数据"><a href="#写数据" class="headerlink" title="写数据"></a>写数据</h3><h4 id="writer"><a href="#writer" class="headerlink" title="writer()"></a>writer()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入csv模块</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">member_list = [</span><br><span class="line">    [<span class="string">&#x27;邱大仁&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;徐小刚&#x27;</span>, <span class="string">&#x27;陈知枫&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;王晴&#x27;</span>, <span class="string">&#x27;廖雨&#x27;</span>]</span><br><span class="line">    ]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;writerow_demo.csv&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>,newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="comment"># 打开并创建&#x27;writerow_demo.csv&#x27;文件，注意参数的设置，获取文件对象</span></span><br><span class="line">    writer=csv.writer(file)<span class="comment"># 将文件对象转换为writer对象</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> member_list:<span class="comment"># 循环遍历列表中的元素</span></span><br><span class="line">        writer.writerow(i)<span class="comment"># 将列表中的元素写入csv文件中</span></span><br><span class="line">        <span class="comment">#csv_demo.writerows(member_list)等价for循环上面两个语句</span></span><br></pre></td></tr></table></figure>

<ul>
<li>**对象名.writerow(row)**：要用for循环填入列表中</li>
<li>**对象名.writerows(row)**：参数rows也是可迭代对象，可以理解为由多个row组成。</li>
</ul>
<h4 id="DictWriter"><a href="#DictWriter" class="headerlink" title="DictWriter"></a>DictWriter</h4><ul>
<li><code>DictWriter</code>的操作类似于常规的<code>writer()</code>，但<code>DictWriter</code>会将字典写入（映射）到csv文件的行中</li>
<li>写入的行为字典形式</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249587.png" alt="image-20210813221044806"></p>
<ul>
<li>必须要传入该参数。</li>
<li>我们需要将一个列表传给参数<code>fieldnames</code>，它的作用是设置csv文件的第一行数据（即表头数据）。当我们要将字典通过<code>DictWriter对象</code>写入csv文件时，通常会把字典的键(key)存入一个列表，再把这个列表传给参数<code>fieldnames</code>。</li>
</ul>
<h5 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h5><ol>
<li><code>writeheader()</code>，该方法可将表头（即字典中的键(key)）写入csv的第一行。也就是说，<strong>如果要写入表头，不仅要在DictWriter中传入参数fieldnames，还需要调用writeheader()方法</strong>。这点很重要，一定要记住。</li>
<li><code>writerow(row)</code>，与writer对象调用writerow(row)不同的是，这里的参数<code>row</code>必须是字典形式的数据。</li>
<li>在写入时，该方法会根据字典的键，找到相应的表头，然后再将此键对应的值写入表头对应的列。</li>
<li><strong>writeheader()</strong></li>
<li><strong>writerow（）</strong></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入csv模块</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">info_dict = &#123;<span class="string">&#x27;姓名&#x27;</span>: <span class="string">&#x27;徐小刚&#x27;</span>, <span class="string">&#x27;工号&#x27;</span>: <span class="string">&#x27;1005&#x27;</span>, <span class="string">&#x27;员工发展基金&#x27;</span>: <span class="string">&#x27;100&#x27;</span>, <span class="string">&#x27;员工签字&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置表头</span></span><br><span class="line">headers = [<span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;工号&#x27;</span>, <span class="string">&#x27;员工发展基金&#x27;</span>, <span class="string">&#x27;员工签字&#x27;</span>]</span><br><span class="line"><span class="comment"># 创建并打开&#x27;./徐小刚信息.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./徐小刚信息.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> target_file:</span><br><span class="line">    <span class="comment"># 将文件对象转换为DictWriter对象</span></span><br><span class="line">    target_writer = csv.DictWriter(target_file, fieldnames=headers)<span class="comment">#fieldnames是表头传参</span></span><br><span class="line">    <span class="comment"># 写入表头</span></span><br><span class="line">    target_writer.writeheader()</span><br><span class="line">    <span class="comment"># 将字典写入csv文件</span></span><br><span class="line">    target_writer.writerow(info_dict)</span><br></pre></td></tr></table></figure>
<h1 id="快速获得文件名"><a href="#快速获得文件名" class="headerlink" title="快速获得文件名"></a>快速获得文件名</h1><h2 id="OS模块"><a href="#OS模块" class="headerlink" title="OS模块"></a>OS模块</h2><ul>
<li>操作系统模块，标准库</li>
<li>它常用于处理文件和目录（文件夹）的操作。例如删除文件、判断文件目录是否存在等功能。</li>
</ul>
<h4 id="自动创建文件"><a href="#自动创建文件" class="headerlink" title="自动创建文件"></a>自动创建文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 打开结果文件</span></span><br><span class="line">result_file = <span class="built_in">open</span>(<span class="string">&#x27;./result.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#如果文件名不存在则自动创建，否则就直接可以打开</span></span><br></pre></td></tr></table></figure>
<h3 id="修改文件名"><a href="#修改文件名" class="headerlink" title="修改文件名"></a>修改文件名</h3><ol>
<li>将图片png格式改为jpg格式<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">dirName = <span class="string">&quot;C:\\Users\\win10\\Desktop\\图片\\&quot;</span>        <span class="comment"># 图片所在路径</span></span><br><span class="line"></span><br><span class="line">total_img = os.listdir(dirName)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> total_img:                  <span class="comment"># 索引所有图像</span></span><br><span class="line">    newname = filename</span><br><span class="line">    newname = newname.split(<span class="string">&quot;.&quot;</span>)            <span class="comment"># 分离后缀</span></span><br><span class="line">    <span class="keyword">if</span> newname[-<span class="number">1</span>] == <span class="string">&quot;png&quot;</span>:                <span class="comment"># 假定原后缀为.png格式</span></span><br><span class="line">        newname[-<span class="number">1</span>] = <span class="string">&quot;jpg&quot;</span>                 <span class="comment"># 目标后缀为.jpg格式</span></span><br><span class="line">        newname = <span class="built_in">str</span>.join(<span class="string">&quot;.&quot;</span>, newname)    <span class="comment"># &#x27;.&#x27;与后缀名称相连接</span></span><br><span class="line">        filename = dirName + filename       <span class="comment"># 原始图片路径+名称</span></span><br><span class="line">        newname = dirName + newname         <span class="comment"># 新的图像路径+名称</span></span><br><span class="line">        os.rename(filename, newname)        <span class="comment"># 重命名</span></span><br><span class="line">        <span class="built_in">print</span>(newname, <span class="string">&quot;图片格式修改成功&quot;</span>)</span><br><span class="line"><span class="comment">#将png格式修改为jpg格式</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="listdir-函数"><a href="#listdir-函数" class="headerlink" title="listdir(函数)"></a>listdir(函数)</h3><ul>
<li>格式：<strong>变量名&#x3D;os.listdir(路径)</strong><br>目的：将某文件夹中，所有<strong>文件夹名</strong>和<strong>文件名</strong>获取到<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">path = <span class="string">&#x27;文件夹路径&#x27;</span></span><br><span class="line">filenames = os.listdir(path)</span><br><span class="line"><span class="built_in">print</span>(filenames)<span class="comment">#输出为列表格式</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="保存网页图片"><a href="#保存网页图片" class="headerlink" title="保存网页图片"></a>保存网页图片</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">img_src=<span class="string">&#x27;http://sm-wick-question.oss-cn-zhangjiakou.aliyuncs.com/QuestionAnswerImage/521422ccc14b47ef94adc9d0f5240451-11-question.jpg&#x27;</span></span><br><span class="line">response = requests.get(img_src)</span><br><span class="line">image = Image.<span class="built_in">open</span>(BytesIO(response.content))</span><br><span class="line">image.save(<span class="string">&#x27;C:\\Users\\win10\\Desktop\\9.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="添加表格信息"><a href="#添加表格信息" class="headerlink" title="添加表格信息"></a>添加表格信息</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook, Workbook</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">question</span>(<span class="params">s</span>):</span><br><span class="line">    j=<span class="number">0</span></span><br><span class="line">    s=<span class="built_in">list</span>(s)</span><br><span class="line">    s[s.index(<span class="string">&#x27;q&#x27;</span>)]=<span class="string">&#x27;a&#x27;</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">url_img</span>(<span class="params">scr,path_name</span>):</span><br><span class="line">    response = requests.get(scr)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(response.content))</span><br><span class="line">    <span class="built_in">print</span>(path_name+<span class="string">&quot; 保存成功&quot;</span>)</span><br><span class="line">    image.save(path_name)</span><br><span class="line"></span><br><span class="line">path = <span class="string">&#x27;C:\\Users\\win10\\Desktop\\课程\\微机原理\\&#x27;</span></span><br><span class="line">filenames = os.listdir(path)</span><br><span class="line">new_path=path+<span class="built_in">str</span>(filenames[<span class="number">0</span>])</span><br><span class="line">img_path=<span class="string">&#x27;C:\\Users\\win10\\Desktop\\课程\\pic\\&#x27;</span></span><br><span class="line">staff_wb = load_workbook(new_path)</span><br><span class="line"></span><br><span class="line">staff_ws = staff_wb.active</span><br><span class="line"><span class="comment"># 新建工作簿</span></span><br><span class="line">new_wb = Workbook()</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">new_ws = new_wb.active</span><br><span class="line"><span class="comment">#获取名字</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row,name1 <span class="keyword">in</span> <span class="built_in">zip</span>(staff_ws.iter_rows( max_row=<span class="number">2000</span>, values_only=<span class="literal">True</span>),staff_ws[<span class="string">&#x27;H&#x27;</span>]):</span><br><span class="line">    <span class="comment"># 将数据写入新的工作表</span></span><br><span class="line">    <span class="keyword">if</span>(name1.value==<span class="string">&quot;王俊林&quot;</span>):</span><br><span class="line">        row=<span class="built_in">list</span>(row)</span><br><span class="line">        img_path1=img_path+row[<span class="number">2</span>]+<span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">        url_img(row[<span class="number">3</span>],img_path1)</span><br><span class="line">        row.insert(<span class="number">8</span>,question(row[<span class="number">2</span>]))</span><br><span class="line">        new_ws.append(row)</span><br><span class="line">new_wb.save(<span class="string">&#x27;C:\\Users\\win10\\Desktop\\表格.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;生成成功&quot;</span>)</span><br><span class="line"><span class="comment">#读取有王俊林表格的整个信息，并保存到一个表格中</span></span><br></pre></td></tr></table></figure>
<h2 id="文件筛选"><a href="#文件筛选" class="headerlink" title="文件筛选"></a>文件筛选</h2><p>流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249425.png" alt="image-20210812211800776"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置文件夹路径，获取文件夹下的所有文件名</span></span><br><span class="line">path = <span class="string">&#x27;./工作文件夹/&#x27;</span></span><br><span class="line">files_list = os.listdir(path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置需要查找的关键词</span></span><br><span class="line">key_word = <span class="built_in">input</span>(<span class="string">&quot;请输入要查找的关键词：&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开结果文件</span></span><br><span class="line">result_file = <span class="built_in">open</span>(<span class="string">&#x27;./result.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环处理每一个文件</span></span><br><span class="line"><span class="keyword">for</span> file_name <span class="keyword">in</span> files_list:</span><br><span class="line">    <span class="comment"># 判断文件类型是否在文件名中</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;.txt&#x27;</span> <span class="keyword">in</span> file_name:</span><br><span class="line">        <span class="comment"># 找到文件时先打印提示</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;找到了文件：&quot;</span> + file_name)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将文件夹路径和文件名拼接成该文件的相对路径</span></span><br><span class="line">        target_file = path + file_name</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 打开文件，读取文件内容，然后关闭文件</span></span><br><span class="line">        file = <span class="built_in">open</span>(target_file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        content = file.read()</span><br><span class="line">        file.close()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断关键词是否在文件内容中</span></span><br><span class="line">        <span class="keyword">if</span> key_word <span class="keyword">in</span> content:</span><br><span class="line">            <span class="comment"># 匹配到关键词时先打印提示</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;妙啊，文件**&#123;&#125;**包含了关键词：&#123;&#125;&quot;</span>.<span class="built_in">format</span>(target_file, key_word))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 将包含关键词的文档的文件路径，写入结果文件。</span></span><br><span class="line">            result_file.write(target_file + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭结果文件</span></span><br><span class="line">result_file.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>相对路径</strong>使用两个特殊符号，点<code>.</code>和双点<code>..</code>，点<code>.</code>表示当前的目录，双点<code>..</code>表示当前目录的上一级目录。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#【工作文件夹】与【oa_01.py】都在【codes文件夹】中，所以【工作文件夹】和【codes文件夹】的相对路径就可以表示为：</span></span><br><span class="line"><span class="comment"># &#x27;工作文件夹&#x27;的相对路径</span></span><br><span class="line"><span class="string">&#x27;./工作文件夹/&#x27;</span></span><br><span class="line"><span class="comment"># &#x27;codes&#x27;的相对路径</span></span><br><span class="line"><span class="string">&#x27;./&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249064.png" alt="image-20210812213713336"></p>
<h1 id="对excel操作"><a href="#对excel操作" class="headerlink" title="对excel操作"></a>对excel<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_59235508/article/details/122712465?ops_request_misc=&request_id=&biz_id=102&utm_term=pytoh%E5%AF%B9exce%E8%A1%A8%E6%A0%BC%E5%A4%8D%E5%88%B6&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-122712465.142%5Ev10%5Econtrol,157%5Ev8%5Econtrol&spm=1018.2226.3001.4187">操作</a></h1><p>python操作excel主要用到xlrd和xlwt这两个库，即xlrd是读excel，xlwt是写excel的库</p>
<h2 id="xlrd模块"><a href="#xlrd模块" class="headerlink" title="xlrd模块"></a>xlrd模块</h2><p>读模块<br>有点问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlrd</span><br><span class="line"><span class="comment">#data = xlrd.open_workbook(filename)#文件名以及路径，如果路径或者文件名有中文给前面加一个 r</span></span><br><span class="line">xlsx = xlrd.open_workbook(<span class="string">&#x27;C:\\Users\\wjl\\Desktop\\表格.xlsx&#x27;</span>)<span class="comment">#读取</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过sheet名查找：xlsx.sheet_by_name(&quot;sheet1&quot;)</span></span><br><span class="line"><span class="comment"># 通过索引查找：xlsx.sheet_by_index(3)</span></span><br><span class="line">table = xlsx.sheet_by_index(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取单个表格值 (2,1)表示获取第3行第2列单元格的值</span></span><br><span class="line">value = table.cell_value(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;第3行2列值为&quot;</span>,value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取表格行数</span></span><br><span class="line">nrows = table.nrows</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;表格一共有&quot;</span>,nrows,<span class="string">&quot;行&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取第4列所有值（列表生成式）</span></span><br><span class="line">name_list = [<span class="built_in">str</span>(table.cell_value(i, <span class="number">3</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, nrows)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;第4列所有的值：&quot;</span>,name_list)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="xlwt模块操作"><a href="#xlwt模块操作" class="headerlink" title="xlwt模块操作"></a>xlwt模块操作</h2><p>写模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入xlwt模块</span></span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 1.创建 Workbook</span></span><br><span class="line">wb = xlwt.Workbook()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.创建 worksheet</span></span><br><span class="line">ws = wb.add_sheet(<span class="string">&#x27;test_sheet&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 3.写入第一行内容  ws.write(a, b, c)  a：行，b：列，c：内容</span></span><br><span class="line">ws.write(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;球队&#x27;</span>)</span><br><span class="line">ws.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;号码&#x27;</span>)</span><br><span class="line">ws.write(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&#x27;姓名&#x27;</span>)</span><br><span class="line">ws.write(<span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;位置&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 保存文件</span></span><br><span class="line">wb.save(<span class="string">&#x27;C:\\Users\\wjl\\Desktop\\myExcel.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202205241207709.png" alt="image-20220524120653747"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlst</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 1.创建 Workbook</span></span><br><span class="line">wb = xlwt.Workbook()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 2.创建 worksheet</span></span><br><span class="line">ws = wb.add_sheet(<span class="string">&#x27;test_sheet&#x27;</span>)</span><br><span class="line">data = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;Team&#x27;</span>: <span class="string">&#x27;湖人&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Number&#x27;</span>: <span class="string">&#x27;34&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;奥尼尔&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Positions&#x27;</span>: <span class="string">&#x27;中锋&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;Team&#x27;</span>: <span class="string">&#x27;湖人&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Number&#x27;</span>: <span class="string">&#x27;24&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;科比&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Positions&#x27;</span>: <span class="string">&#x27;后卫&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;Team&#x27;</span>: <span class="string">&#x27;湖人&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Number&#x27;</span>: <span class="string">&#x27;23&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;詹姆斯&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Positions&#x27;</span>: <span class="string">&#x27;前锋&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(data):</span><br><span class="line">    ws.write(i+<span class="number">1</span>, <span class="number">0</span>, item[<span class="string">&#x27;Team&#x27;</span>])</span><br><span class="line">    ws.write(i+<span class="number">1</span>, <span class="number">1</span>, item[<span class="string">&#x27;Number&#x27;</span>])</span><br><span class="line">    ws.write(i+<span class="number">1</span>, <span class="number">2</span>, item[<span class="string">&#x27;Name&#x27;</span>])</span><br><span class="line">    ws.write(i+<span class="number">1</span>, <span class="number">3</span>, item[<span class="string">&#x27;Positions&#x27;</span>])</span><br><span class="line">wb.save(<span class="string">&#x27;C:\\Users\\win10\\Desktop\\myExcel.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202205241207980.png" alt="image-20220524120730735"></p>
<h1 id="excel按照姓名分表"><a href="#excel按照姓名分表" class="headerlink" title="excel按照姓名分表"></a>excel按照姓名分表</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置员工发展基金确认表路径</span></span><br><span class="line">source_path = <span class="string">&#x27;./员工发展基金确认表.csv&#x27;</span></span><br><span class="line"><span class="comment"># 设置存放拆分结果文件的文件夹路径</span></span><br><span class="line">result_path = <span class="string">&#x27;./员工发展基金文件夹_demo/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开员工发展基金确认表</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(source_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> source_file:<span class="comment">#newline=&#x27;&#x27;:这样可以避免一些不必要的空行</span></span><br><span class="line">    <span class="comment"># 将文件对象转换为DictReader对象</span></span><br><span class="line">    source_csv = csv.DictReader(source_file)</span><br><span class="line">    <span class="comment"># 将csv对象的表头读取出来</span></span><br><span class="line">    headers = source_csv.fieldnames</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 循环处理确认表中除表头外的每一行数据</span></span><br><span class="line">    <span class="keyword">for</span> csv_row <span class="keyword">in</span> source_csv:</span><br><span class="line">        <span class="comment"># 根据获取的员工名字拼接新文件名</span></span><br><span class="line">        file_name = csv_row[<span class="string">&#x27;姓名&#x27;</span>] + <span class="string">&#x27;.csv&#x27;</span></span><br><span class="line">        <span class="comment"># 拼接新文件路径</span></span><br><span class="line">        file_path = result_path + file_name</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 创建新文件并添加数据</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> target_file:</span><br><span class="line">            <span class="comment"># 将文件对象转换为DictWriter对象</span></span><br><span class="line">            target_writer = csv.DictWriter(target_file, fieldnames=headers)</span><br><span class="line">            <span class="comment"># 写入表头</span></span><br><span class="line">            target_writer.writeheader()</span><br><span class="line">            <span class="comment"># 写入数据</span></span><br><span class="line">            target_writer.writerow(csv_row)</span><br></pre></td></tr></table></figure>
<h1 id="openpyxl库"><a href="#openpyxl库" class="headerlink" title="openpyxl库"></a>openpyxl库</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249825.png" alt="image-20210814100038376"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249164.png" alt="image-20210817093103821"></p>
<ul>
<li>安装库：pip install openpyxl</li>
</ul>
<p>（Windows系统）cmd中输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install 库/模块名</span><br></pre></td></tr></table></figure>

<ul>
<li>处理<code>xlsx</code>格式表格的相关内容。</li>
</ul>
<h2 id="获取对象及创建"><a href="#获取对象及创建" class="headerlink" title="获取对象及创建"></a>获取对象及创建</h2><ul>
<li>load_workbook(filename)</li>
<li>filename代表工作簿的路径</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="comment"># 通过文件路径，打开工作簿</span></span><br><span class="line">wb1 = openpyxl.load_workbook(<span class="string">&#x27;./demo_excel.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 用 Workbook() 创建新工作簿</span></span><br><span class="line">wb2 = openpyxl.Workbook()</span><br><span class="line"></span><br><span class="line"><span class="comment">#方法2</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook, Workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过文件路径，打开已有工作簿</span></span><br><span class="line">wb1 = load_workbook(<span class="string">&#x27;./demo_excel.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 用 Workbook() 创建新工作簿</span></span><br><span class="line">wb2 = Workbook()</span><br></pre></td></tr></table></figure>

<h2 id="新建工作簿2"><a href="#新建工作簿2" class="headerlink" title="新建工作簿2"></a>新建工作簿2</h2><h3 id="Workbook"><a href="#Workbook" class="headerlink" title="Workbook()"></a><strong>Workbook()</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建工作簿</span></span><br><span class="line">new_wb = Workbook()</span><br><span class="line"><span class="comment"># 打印工作簿对象</span></span><br><span class="line"><span class="built_in">print</span>(new_wb)</span><br></pre></td></tr></table></figure>

<h3 id="工作簿对象-save-filename"><a href="#工作簿对象-save-filename" class="headerlink" title="工作簿对象.save(filename)"></a>工作簿对象.save(filename)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建工作簿</span></span><br><span class="line">new_wb = Workbook()</span><br><span class="line"><span class="comment"># 将新建的工作簿保存为【new_excel.xlsx】</span></span><br><span class="line">new_wb.save(<span class="string">&#x27;./new_excel.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>如果参数<code>filename</code>不变，即保存在原有路径，相当于修改原文件；若参数<code>filename</code>变化，即保存在新的路径，相当于另存为新的文件。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249450.png" alt="image-20210814095339493"></p>
<h2 id="工作表对象"><a href="#工作表对象" class="headerlink" title="工作表对象"></a>工作表对象</h2><ul>
<li>Worksheet对象</li>
</ul>
<h3 id="获取工作表对象1"><a href="#获取工作表对象1" class="headerlink" title="获取工作表对象1"></a>获取工作表对象1</h3><ul>
<li><strong>active</strong>:active会获取到活动的工作表</li>
<li>建议单一工作表使用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./codes/material/公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">active_ws = staff_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印工作簿对象</span></span><br><span class="line"><span class="built_in">print</span>(staff_wb)</span><br><span class="line"><span class="comment"># 打印工作表对象</span></span><br><span class="line"><span class="built_in">print</span>(active_ws)</span><br></pre></td></tr></table></figure>

<h3 id="按表名取表2"><a href="#按表名取表2" class="headerlink" title="按表名取表2"></a>按表名取表2</h3><ul>
<li>工作簿对象[‘表名’]</li>
<li>建议多张工作表使用，获取指定工作表对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./codes/material/公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 按表名取表</span></span><br><span class="line">fhy_ws = staff_wb[<span class="string">&#x27;上半年公司名单&#x27;</span>]  <span class="comment"># fhy为first half year（上半年）的缩写；工作表对象</span></span><br><span class="line">shy_ws = staff_wb[<span class="string">&#x27;下半年公司名单&#x27;</span>]  <span class="comment"># shy为second half year（下半年）的缩写</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印工作簿对象</span></span><br><span class="line"><span class="built_in">print</span>(staff_wb)</span><br><span class="line"><span class="comment"># 打印工作表对象</span></span><br><span class="line"><span class="built_in">print</span>(fhy_ws)</span><br><span class="line"><span class="built_in">print</span>(shy_ws)</span><br></pre></td></tr></table></figure>

<h3 id="获取单行或单列"><a href="#获取单行或单列" class="headerlink" title="获取单行或单列"></a>获取单行或单列</h3><ul>
<li>数字代表行，英文字母代表列</li>
<li>通过<strong>工作表对象[行数]或</strong>工作表对象<code>[&#39;列名&#39;]</code><strong>的方式获取到一个</strong>元组，这个<strong>元组</strong>中包含了指定行或列中的所有数据。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./codes/material/公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">active_ws = staff_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印获取到的第五行数据</span></span><br><span class="line"><span class="built_in">print</span>(active_ws[<span class="number">5</span>])</span><br><span class="line"><span class="comment"># 打印获取到的第二列数据</span></span><br><span class="line"><span class="built_in">print</span>(active_ws[<span class="string">&#x27;B&#x27;</span>])<span class="comment">#每一个元素均为&lt;Cell &#x27;工作表名称&#x27;.坐标&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>每一个元素均为&lt;Cell ‘工作表名称’.坐标&gt;</li>
</ul>
<h3 id="获取多行数据"><a href="#获取多行数据" class="headerlink" title="获取多行数据"></a>获取多行数据</h3><h4 id="iter-rows"><a href="#iter-rows" class="headerlink" title="iter_rows"></a>iter_rows</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">工作表对象.iter_rows(min_row, max_row, min_col, max_col, values_only=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#min_row是最小行索引</span></span><br><span class="line"><span class="comment">#max_row是最大行索引</span></span><br><span class="line"><span class="comment">#min_col是最小列索引</span></span><br><span class="line"><span class="comment">#max_col是最大列索引</span></span><br><span class="line"><span class="comment">#values_only=True:是否返回单元格的值</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./codes/material/公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取【&#x27;上半年公司名单&#x27;】工作表</span></span><br><span class="line">fhy_ws = staff_wb[<span class="string">&#x27;上半年公司名单&#x27;</span>]</span><br><span class="line"><span class="comment"># 返回第2行至第12行，第2列（B列）至第3列（C列）这个范围的单元格内的所有数据（值）</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> fhy_ws.iter_rows(min_row=<span class="number">2</span>, max_row=<span class="number">12</span>, min_col=<span class="number">2</span>, max_col=<span class="number">3</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="built_in">print</span>(row)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>最小行索引的值默认为1，最大行索引的值默认为表格中有数据的最下面一行的行数；</li>
<li>参数<code>values_only</code>决定是否返回单元格的值，如果为True则返回<strong>单元格的值</strong>，如果为False则返回<strong>单元格对象</strong>。通常情况下，只读数据时，需要将该参数设置为True，要写入数据时，保持其为默认的False就好。</li>
<li>如果指定的行中没有数据，就会返回一个空的元组。(None, None)</li>
</ul>
<h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><ul>
<li>语法：<strong>工作表对象.append(列表&#x2F;元组)</strong></li>
<li>使用后保存，用save（）函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">active_ws = staff_wb.active</span><br><span class="line">info_list = [<span class="string">&#x27;S1911&#x27;</span>, <span class="string">&#x27;萧爵瑟&#x27;</span>, <span class="number">3000</span>, <span class="string">&#x27;内容&#x27;</span>]</span><br><span class="line">info_tuple = (<span class="string">&#x27;S1912&#x27;</span>, <span class="string">&#x27;吴琐薇&#x27;</span>, <span class="number">5000</span>, <span class="string">&#x27;销售&#x27;</span>)</span><br><span class="line">active_ws.append(info_list)</span><br><span class="line">active_ws.append(info_tuple)</span><br><span class="line"><span class="comment"># 保存工作簿为【append_demo.xlsx】</span></span><br><span class="line">staff_wb.save(<span class="string">&#x27;./append_demo.xlsx&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="单元格对象"><a href="#单元格对象" class="headerlink" title="单元格对象"></a>单元格对象</h2><ul>
<li>单元格对象代表工作表中的一个单元格。</li>
</ul>
<h3 id="获取单元格对象"><a href="#获取单元格对象" class="headerlink" title="获取单元格对象"></a>获取单元格对象</h3><p>1、通过for row in 工作表对象.iter_rows()来获取指定范围的行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#for cell in 工作表对象[行数]</span></span><br><span class="line"><span class="comment">#for cell in 工作表对象[&#x27;列名&#x27;]</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./codes/material/公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">staff_ws = staff_wb.active</span><br><span class="line"><span class="comment"># for循环遍历，取出第三行的所有单元格对象</span></span><br><span class="line"><span class="keyword">for</span> row_cell <span class="keyword">in</span> staff_ws[<span class="number">3</span>]:</span><br><span class="line">    <span class="built_in">print</span>(row_cell)</span><br><span class="line"><span class="comment"># for循环遍历，取出第三列（C列）的所有单元格对象</span></span><br><span class="line"><span class="keyword">for</span> col_cell <span class="keyword">in</span> staff_ws[<span class="string">&#x27;C&#x27;</span>]:</span><br><span class="line">    <span class="built_in">print</span>(col_cell)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3、<strong>工作表对象[‘单元格坐标’]</strong></p>
<ul>
<li>工作表对象[‘A1’]就会获取到表格中，A1那个单元格对应的单元格对象</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="comment"># 打开【公司人员名单.xlsx】工作簿</span></span><br><span class="line">staff_wb = load_workbook(<span class="string">&#x27;./codes/material/公司人员名单.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">staff_ws = staff_wb.active</span><br><span class="line"><span class="comment"># 打印单元格对象A1</span></span><br><span class="line"><span class="built_in">print</span>(staff_ws[<span class="string">&#x27;A1&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="单元格对象的基本操作"><a href="#单元格对象的基本操作" class="headerlink" title="单元格对象的基本操作"></a>单元格对象的基本操作</h3><ul>
<li>借助单元格对象的属性value，我们就可以得到具体的数据；同时，我们也可以通过这个属性给单元格对象赋值（修改单元格的值或给单元格添加值）。</li>
<li>直接赋值操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取单元格的值单元格对象.value</span></span><br><span class="line"><span class="comment"># 给单元格对象赋值单元格对象.value = 值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从openpyxl库导入load_workbook函数</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="comment"># 打开【10月员工绩效表】的工作簿，获取活动工作表</span></span><br><span class="line">performance_wb  = load_workbook(<span class="string">&#x27;./material/10月员工绩效表.xlsx&#x27;</span>)</span><br><span class="line">performance_ws = performance_wb.active</span><br><span class="line"><span class="comment"># 取出[&#x27;A1&#x27;]单元格对象</span></span><br><span class="line">cell1 = performance_ws[<span class="string">&#x27;A1&#x27;</span>]</span><br><span class="line"><span class="comment"># 使用单元格对象的value属性取出单元格的值，并打印</span></span><br><span class="line"><span class="built_in">print</span>(cell1.value)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">performance = ws[<span class="string">&#x27;E11&#x27;</span>].value	<span class="comment">#赋值</span></span><br><span class="line">ws[<span class="string">&#x27;H1&#x27;</span>].value = <span class="string">&#x27;总工资&#x27;</span> <span class="comment">#改写赋值</span></span><br></pre></td></tr></table></figure>

<h1 id="常见语法错误"><a href="#常见语法错误" class="headerlink" title="常见语法错误"></a>常见语法错误</h1><h2 id="语法错误"><a href="#语法错误" class="headerlink" title="语法错误"></a>语法错误</h2><ul>
<li>语法错误(syntax errors)是初学者最容易犯的错误</li>
<li>当你的代码完全符合Python的语法规范后，就该尝试运行程序了。但在程序运行过程中，还是有可能会发生问题，我们把这类问题称为**异常(exceptions)**。</li>
<li>代码不符合Python的语法规范，比如漏了冒号，混用中英文符号等，就会出现这种错误。</li>
</ul>
<h3 id="SyntaxError"><a href="#SyntaxError" class="headerlink" title="SyntaxError"></a>SyntaxError</h3><ul>
<li><p><strong>SyntaxError: invalid syntax（无效语法）</strong></p>
<ul>
<li>遗漏了标点符号</li>
<li>关键字拼写错误或遗漏</li>
<li>变量名或函数名使用了关键字。</li>
</ul>
</li>
<li><p><strong>SyntaxError: invalid character in identifier（标识符中有无效字符）</strong></p>
<ul>
<li>代码里使用了大量中文符号</li>
</ul>
</li>
<li><p><strong>SyntaxError: EOL while scanning string literal（检查到不完整的字符串）</strong></p>
<ul>
<li>遗漏了字符串两边的引号，或者混用了引号</li>
</ul>
</li>
</ul>
<h3 id="IndentationError"><a href="#IndentationError" class="headerlink" title="IndentationError"></a>IndentationError</h3><ul>
<li><strong>缩进错误</strong><ul>
<li><strong>IndentationError: expected an indented block（需要缩进的代码块）</strong></li>
</ul>
</li>
<li><strong>IndentationError: unindent does not match any outer indentation level（缩进内容不匹配任何一个层级）</strong></li>
</ul>
<h2 id="常见异常"><a href="#常见异常" class="headerlink" title="常见异常"></a>常见异常</h2><h3 id="TypeError类型错误"><a href="#TypeError类型错误" class="headerlink" title="TypeError类型错误"></a>TypeError类型错误</h3><ul>
<li><strong>异常</strong>的“错误消息”会显示Traceback (most recent call last）<ul>
<li><strong>TypeError: unsupported operand type(s) for …（不支持的运算）</strong></li>
</ul>
</li>
<li><strong>TypeError: can only concatenate str (not “int”) to str （只能用字符串拼接字符串）</strong></li>
<li><strong>TypeError: ‘xxx’ object is not iterable（对象不可被迭代）</strong><ul>
<li>可迭代对象应该包括：字符串类型，列表，元组和字典。剩下的一些类型，比如：int类型，float类型，布尔类型和None就不是可迭代对象。</li>
</ul>
</li>
</ul>
<h3 id="IndexError"><a href="#IndexError" class="headerlink" title="IndexError"></a>IndexError</h3><ul>
<li>IndexError这个异常，和列表取值有关。</li>
<li><strong>索引错误</strong>是<strong>IndexError: list index out of range（索引超出了范围）</strong></li>
</ul>
<h3 id="操作文件异常"><a href="#操作文件异常" class="headerlink" title="操作文件异常"></a>操作文件异常</h3><h4 id="ModuleNotFoundError"><a href="#ModuleNotFoundError" class="headerlink" title="ModuleNotFoundError"></a>ModuleNotFoundError</h4><ul>
<li>ModuleNotFoundError 未找到模块错误，是一种有关模块的异常</li>
<li>检查模块名是否拼写正确</li>
</ul>
<h4 id="AttributeError"><a href="#AttributeError" class="headerlink" title="AttributeError"></a>AttributeError</h4><ul>
<li>检查模块是否使用了不存在的方法或属性</li>
<li>检查方法或属性是否正确</li>
</ul>
<h4 id="FileNotFoundError"><a href="#FileNotFoundError" class="headerlink" title="FileNotFoundError:"></a>FileNotFoundError:</h4><ul>
<li>检查文件路径是否正确</li>
</ul>
<h4 id="FileNotFoundError-1"><a href="#FileNotFoundError-1" class="headerlink" title="FileNotFoundError:"></a>FileNotFoundError:</h4><ul>
<li>检查encoding的编码类型和实际文件是否一致</li>
</ul>
<h1 id="案例学习"><a href="#案例学习" class="headerlink" title="案例学习"></a>案例学习</h1><ul>
<li>选取部分行：语法:new_row &#x3D; [row[1],row[3], row[5]]</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041249975.png" alt="image-20210817102224209"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041250249.png" alt="image-20210817115202085"></p>
<h2 id="获取个人工资信息"><a href="#获取个人工资信息" class="headerlink" title="获取个人工资信息"></a>获取个人工资信息</h2><ul>
<li>我们需要从【10月员工绩效表】中找到江宇的信息，然后写入【江宇工资信息表】中10月工资信息对应的行</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/202201041250001.png" alt="image-20210817095621289"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">code_highlight_9.py</span><br><span class="line"><span class="comment"># 从openpyxl库导入load_workbook函数</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【10月员工绩效表】的工作簿，获取活动工作表</span></span><br><span class="line">performance_wb  = load_workbook(<span class="string">&#x27;./material/10月员工绩效表.xlsx&#x27;</span>)</span><br><span class="line">performance_ws = performance_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【江宇工资信息表】的工作簿，获取活动工作表</span></span><br><span class="line">info_wb = load_workbook(<span class="string">&#x27;./material/江宇工资信息表.xlsx&#x27;</span>)</span><br><span class="line">info_ws = info_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取【绩效】值</span></span><br><span class="line">performance = performance_ws[<span class="string">&#x27;D14&#x27;</span>].value</span><br><span class="line"><span class="comment"># 获取【奖金】值</span></span><br><span class="line">bonus = performance_ws[<span class="string">&#x27;E14&#x27;</span>].value</span><br><span class="line"><span class="comment"># 获取【基本工资】值</span></span><br><span class="line">base = performance_ws[<span class="string">&#x27;F14&#x27;</span>].value</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入【绩效】值</span></span><br><span class="line">info_ws[<span class="string">&#x27;E11&#x27;</span>].value = performance</span><br><span class="line"><span class="comment"># 写入【奖金】值</span></span><br><span class="line">info_ws[<span class="string">&#x27;F11&#x27;</span>].value = bonus</span><br><span class="line"><span class="comment"># 写入【基本工资】值</span></span><br><span class="line">info_ws[<span class="string">&#x27;G11&#x27;</span>].value = base</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存对【江宇工资信息表】工作簿的写入</span></span><br><span class="line">info_wb.save(<span class="string">&#x27;./material/江宇工资信息表.xlsx&#x27;</span>)</span><br><span class="line">点击这里可以改变学习模式～</span><br></pre></td></tr></table></figure>

<h2 id="生成前十行绩效信息表"><a href="#生成前十行绩效信息表" class="headerlink" title="生成前十行绩效信息表"></a>生成前十行绩效信息表</h2><ul>
<li>是需要从【10月员工绩效表】中提取前十行信息，写入一个新的工作簿。这样，保存后可以用作员工绩效信息的模板表格。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从openpyxl库导入load_workbook和Workbook</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook, Workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【10月员工绩效表.xlsx】工作簿</span></span><br><span class="line">performance_wb = load_workbook(<span class="string">&#x27;C:\\Users\\win10\\Desktop\\code\\.vscode\\10月员工绩效表.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">performance_ws = performance_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建工作簿</span></span><br><span class="line">new_wb = Workbook()</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">new_ws = new_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取performance_ws的前十行数据</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> performance_ws.iter_rows(max_row=<span class="number">10</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="comment"># 将数据写入新的工作表</span></span><br><span class="line">    new_ws.append(row)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存新工作簿为【员工绩效表-模板.xlsx】</span></span><br><span class="line">new_wb.save(<span class="string">&#x27;C:\\Users\\win10\\Desktop\\10月员工绩效表.xlsx员工绩效表-模板.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="计算并打印奖金信息"><a href="#计算并打印奖金信息" class="headerlink" title="计算并打印奖金信息"></a>计算并打印奖金信息</h2><ul>
<li>依然是从【10月员工绩效表】提取所有员工的工资信息，然后根据每行中员工的“绩效”与“提成”的数值之和，计算出奖金总额，最后按照固定格式输出每位员工的奖金信息。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从openpyxl库导入load_workbook和Workbook</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook, Workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【10月员工绩效表.xlsx】工作簿</span></span><br><span class="line">performance_wb = load_workbook(<span class="string">&#x27;./material/10月员工绩效表.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">performance_ws = performance_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取performance_ws中除表头外的数据</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> performance_ws.iter_rows(min_row=<span class="number">2</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="comment"># 读取【工号】</span></span><br><span class="line">    staff_id = row[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># 读取【员工姓名】</span></span><br><span class="line">    staff_name = row[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 读取【绩效】</span></span><br><span class="line">    performance = row[<span class="number">3</span>]</span><br><span class="line">    <span class="comment"># 读取【提成】</span></span><br><span class="line">    bonus = row[<span class="number">4</span>]</span><br><span class="line">    <span class="comment"># 计算“奖金”</span></span><br><span class="line">    award = performance + bonus</span><br><span class="line">    <span class="comment"># 打印结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;工号：&#123;&#125;，姓名：&#123;&#125;，本月奖金为：&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(staff_id, staff_name, award))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="创建薪资信息字典"><a href="#创建薪资信息字典" class="headerlink" title="创建薪资信息字典"></a>创建薪资信息字典</h2><ul>
<li>要从这个总的薪资表中，读取所需数据范围的行数据，然后取出部分信息，将其对应存储在字典中。</li>
<li>【10月薪资绩效表】中的员工信息比较多，如果要找到某位同事（比如找到江宇的绩效、基本工资等）得按行整个查找一遍。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从openpyxl库导入load_workbook函数</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【10月员工绩效表.xlsx】工作簿</span></span><br><span class="line">performance_wb = load_workbook(<span class="string">&#x27;./material/10月员工绩效表.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">performance_ws = performance_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建员工信息字典</span></span><br><span class="line">staff_info = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从第二行开始读取工作表中的信息</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> performance_ws.iter_rows(min_row=<span class="number">2</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="comment"># 取出工号</span></span><br><span class="line">    member_number = row[<span class="number">0</span>]<span class="comment">#某行对应的数列序号</span></span><br><span class="line">    <span class="comment"># 将信息存入员工信息字典</span></span><br><span class="line">    staff_info[member_number] = &#123;  			<span class="comment">#staff_info[member_number]:以工号键；字典嵌套</span></span><br><span class="line">         <span class="string">&#x27;姓名&#x27;</span>: row[<span class="number">1</span>],<span class="comment">#row[1]元组索引</span></span><br><span class="line">         <span class="string">&#x27;部门&#x27;</span>: row[<span class="number">2</span>],</span><br><span class="line">         <span class="string">&#x27;绩效&#x27;</span>: row[<span class="number">3</span>],</span><br><span class="line">         <span class="string">&#x27;奖金&#x27;</span>: row[<span class="number">4</span>],</span><br><span class="line">         <span class="string">&#x27;基本工资&#x27;</span>: row[<span class="number">5</span>],</span><br><span class="line">         <span class="string">&#x27;是否确认&#x27;</span>: row[<span class="number">6</span>]</span><br><span class="line">     &#125;</span><br><span class="line"><span class="built_in">print</span>(staff_info)</span><br></pre></td></tr></table></figure>

<h1 id="筛选匹配"><a href="#筛选匹配" class="headerlink" title="筛选匹配"></a>筛选匹配</h1><ul>
<li>在【10月考勤统计.xlsx】工作簿中，保存了公司一百名员工的迟到信息，这些信息包含了<strong>迟到时间</strong>和<strong>迟到次数</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook, Workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开【10月考勤统计.xlsx】工作簿</span></span><br><span class="line">wb = load_workbook(<span class="string">&#x27;./material/10月考勤统计.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取活动工作表</span></span><br><span class="line">ws = wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取表头</span></span><br><span class="line">late_header = []</span><br><span class="line"><span class="keyword">for</span> cell <span class="keyword">in</span> ws[<span class="number">1</span>]:</span><br><span class="line">    late_header.append(cell.value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建工作簿</span></span><br><span class="line">new_wb = Workbook()</span><br><span class="line"><span class="comment"># 获取新工作簿中的工作表</span></span><br><span class="line">new_ws = new_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将表头写入新工作簿的工作表中</span></span><br><span class="line">new_ws.append(late_header)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从第二行开始遍历表格</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="comment"># 取出姓名，迟到时间和迟到次数</span></span><br><span class="line">    name = row[<span class="number">1</span>]</span><br><span class="line">    time = row[<span class="number">3</span>]</span><br><span class="line">    number = row[-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 判断是否迟到</span></span><br><span class="line">    <span class="keyword">if</span> time &gt; <span class="number">45</span> <span class="keyword">and</span> number &gt; <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125;迟到了&#123;&#125;分钟，迟到了&#123;&#125;次&#x27;</span>.<span class="built_in">format</span>(name, time, number))</span><br><span class="line">        <span class="comment"># 将迟到人员信息写入新工作簿的工作表中</span></span><br><span class="line">        new_ws.append(row)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将新工作簿保存为【10月迟到人员信息.xlsx】</span></span><br><span class="line">new_wb.save(<span class="string">&#x27;./material/10月迟到人员信息.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="数据匹配"><a href="#数据匹配" class="headerlink" title="数据匹配"></a>数据匹配</h1><ul>
<li>使用字典，把可以<strong>连接</strong>表格的数据作为键，要匹配的数据作为值</li>
<li>再将另一个表格中要匹配的值与字典中对应的值关联起来，实现匹配逻辑</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开工作簿【10月考勤统计.xlsx】，获取活动工作表</span></span><br><span class="line">wb = load_workbook(<span class="string">&#x27;./material/10月考勤统计.xlsx&#x27;</span>)</span><br><span class="line">ws = wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建迟到人员字典</span></span><br><span class="line">info_dict = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环读取除表头外的表格数据</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="comment"># 取出员工工号</span></span><br><span class="line">    staff_id = row[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># 取出迟到次数</span></span><br><span class="line">    staff_late = row[-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 将信息添加入字典，字典格式为&#123;&#x27;员工工号&#x27;: &#x27;迟到次数&#x27;&#125;</span></span><br><span class="line">    info_dict[staff_id] = staff_late</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开工作簿【迟到次数月度统计（10月更新）.xlsx】，获取活动工作表</span></span><br><span class="line">monthly_wb = load_workbook(<span class="string">&#x27;./material/迟到次数月度统计（10月更新）.xlsx&#x27;</span>)</span><br><span class="line">monthly_ws = monthly_wb.active</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环读取出表头外的表格数据</span></span><br><span class="line"><span class="keyword">for</span> monthly_row <span class="keyword">in</span> monthly_ws.iter_rows(min_row=<span class="number">3</span>, max_col=<span class="number">13</span>, values_only=<span class="literal">True</span>):</span><br><span class="line">    <span class="comment"># 取出员工工号</span></span><br><span class="line">    member_id = monthly_row[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># 取出十月份的迟到次数</span></span><br><span class="line">    member_late = monthly_row[-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 匹配迟到次数是否相等</span></span><br><span class="line">    <span class="keyword">if</span> member_late != info_dict[member_id]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;工号&#123;&#125;迟到情况不匹配，请核查后更新&#x27;</span>.<span class="built_in">format</span>(member_id))</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://github.com/wjl-a/data.github.io">醉卿枫</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://github.com/wjl-a/data.github.io/post/f405ebe7.html">https://github.com/wjl-a/data.github.io/post/f405ebe7.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://github.com/wjl-a/data.github.io" target="_blank">醉卿枫の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/data.github.io/tags/python-python%E8%AF%AD%E6%B3%95/">python/python语法</a></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2022/05/29/62939662553c9.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/data.github.io/post/7387e15a.html" title="1.python基础1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/29/62939662553c9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">1.python基础1</div></div></a></div><div><a href="/data.github.io/post/65cd25d3.html" title="2.python基础进阶"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/06/05/629c5257753d1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">2.python基础进阶</div></div></a></div><div><a href="/data.github.io/post/9aab5b6a.html" title="3.python进阶2"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/29/62939662553c9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">3.python进阶2</div></div></a></div><div><a href="/data.github.io/post/3117290d.html" title="4.python模块"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/26/628fa0426213d.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">4.python模块</div></div></a></div><div><a href="/data.github.io/post/df468e0.html" title="6.python数据分析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/26/628fa0426213d.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">6.python数据分析</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wjlpicture.oss-cn-beijing.aliyuncs.com/img/12.png" onerror="this.onerror=null;this.src='/data.github.io/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">醉卿枫</div><div class="author-info__description">学习记录</div></div><div class="card-info-data site-data is-center"><a href="/data.github.io/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/data.github.io/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/data.github.io/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC"><span class="toc-number">1.</span> <span class="toc-text">自动化办公</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">2.</span> <span class="toc-text">文件读写</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80-open%EF%BC%88%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">开-open（）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E6%B1%87%E6%80%BB"><span class="toc-number">2.1.1.</span> <span class="toc-text">模式汇总</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB-read%EF%BC%88%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">读-read（）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96"><span class="toc-number">2.2.1.</span> <span class="toc-text">直接读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E8%A1%8C%E8%AF%BB%E5%8F%96"><span class="toc-number">2.2.2.</span> <span class="toc-text">按行读取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99-write"><span class="toc-number">2.3.</span> <span class="toc-text">写-write()</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%98w%E2%80%99%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.3.1.</span> <span class="toc-text">‘w’模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%98a%E2%80%99%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">‘a’模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3-close"><span class="toc-number">2.4.</span> <span class="toc-text">关-close()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97with"><span class="toc-number">2.5.</span> <span class="toc-text">关键字with</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#split-%E5%88%86%E5%BC%80%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">2.6.</span> <span class="toc-text">split():分开字符串</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csv%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">csv模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">格式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.1.</span> <span class="toc-text">读数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#reader"><span class="toc-number">3.1.1.1.</span> <span class="toc-text">reader()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84%E8%AF%B4%E6%98%8E"><span class="toc-number">3.1.1.1.1.</span> <span class="toc-text">相对路径说明</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DictReader%E7%B1%BB"><span class="toc-number">3.1.1.2.</span> <span class="toc-text">DictReader类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.2.</span> <span class="toc-text">写数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#writer"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">writer()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DictWriter"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">DictWriter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">3.1.2.2.1.</span> <span class="toc-text">方法</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E8%8E%B7%E5%BE%97%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">4.</span> <span class="toc-text">快速获得文件名</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#OS%E6%A8%A1%E5%9D%97"><span class="toc-number">4.1.</span> <span class="toc-text">OS模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6"><span class="toc-number">4.1.0.1.</span> <span class="toc-text">自动创建文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">4.1.1.</span> <span class="toc-text">修改文件名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#listdir-%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.2.</span> <span class="toc-text">listdir(函数)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87"><span class="toc-number">4.2.</span> <span class="toc-text">保存网页图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%A1%A8%E6%A0%BC%E4%BF%A1%E6%81%AF"><span class="toc-number">4.3.</span> <span class="toc-text">添加表格信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%AD%9B%E9%80%89"><span class="toc-number">4.4.</span> <span class="toc-text">文件筛选</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%B9excel%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">对excel操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#xlrd%E6%A8%A1%E5%9D%97"><span class="toc-number">5.1.</span> <span class="toc-text">xlrd模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xlwt%E6%A8%A1%E5%9D%97%E6%93%8D%E4%BD%9C"><span class="toc-number">5.2.</span> <span class="toc-text">xlwt模块操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#excel%E6%8C%89%E7%85%A7%E5%A7%93%E5%90%8D%E5%88%86%E8%A1%A8"><span class="toc-number">6.</span> <span class="toc-text">excel按照姓名分表</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#openpyxl%E5%BA%93"><span class="toc-number">7.</span> <span class="toc-text">openpyxl库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E5%8F%8A%E5%88%9B%E5%BB%BA"><span class="toc-number">7.1.</span> <span class="toc-text">获取对象及创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%B0%BF2"><span class="toc-number">7.2.</span> <span class="toc-text">新建工作簿2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Workbook"><span class="toc-number">7.2.1.</span> <span class="toc-text">Workbook()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%AF%B9%E8%B1%A1-save-filename"><span class="toc-number">7.2.2.</span> <span class="toc-text">工作簿对象.save(filename)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.3.</span> <span class="toc-text">工作表对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%AF%B9%E8%B1%A11"><span class="toc-number">7.3.1.</span> <span class="toc-text">获取工作表对象1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E8%A1%A8%E5%90%8D%E5%8F%96%E8%A1%A82"><span class="toc-number">7.3.2.</span> <span class="toc-text">按表名取表2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8D%95%E8%A1%8C%E6%88%96%E5%8D%95%E5%88%97"><span class="toc-number">7.3.3.</span> <span class="toc-text">获取单行或单列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="toc-number">7.3.4.</span> <span class="toc-text">获取多行数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#iter-rows"><span class="toc-number">7.3.4.1.</span> <span class="toc-text">iter_rows</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">7.3.5.</span> <span class="toc-text">添加数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.4.</span> <span class="toc-text">单元格对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8D%95%E5%85%83%E6%A0%BC%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.4.1.</span> <span class="toc-text">获取单元格对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">7.4.2.</span> <span class="toc-text">单元格对象的基本操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%AF%AD%E6%B3%95%E9%94%99%E8%AF%AF"><span class="toc-number">8.</span> <span class="toc-text">常见语法错误</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E9%94%99%E8%AF%AF"><span class="toc-number">8.1.</span> <span class="toc-text">语法错误</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SyntaxError"><span class="toc-number">8.1.1.</span> <span class="toc-text">SyntaxError</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IndentationError"><span class="toc-number">8.1.2.</span> <span class="toc-text">IndentationError</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%BC%82%E5%B8%B8"><span class="toc-number">8.2.</span> <span class="toc-text">常见异常</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TypeError%E7%B1%BB%E5%9E%8B%E9%94%99%E8%AF%AF"><span class="toc-number">8.2.1.</span> <span class="toc-text">TypeError类型错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IndexError"><span class="toc-number">8.2.2.</span> <span class="toc-text">IndexError</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6%E5%BC%82%E5%B8%B8"><span class="toc-number">8.2.3.</span> <span class="toc-text">操作文件异常</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ModuleNotFoundError"><span class="toc-number">8.2.3.1.</span> <span class="toc-text">ModuleNotFoundError</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AttributeError"><span class="toc-number">8.2.3.2.</span> <span class="toc-text">AttributeError</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FileNotFoundError"><span class="toc-number">8.2.3.3.</span> <span class="toc-text">FileNotFoundError:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FileNotFoundError-1"><span class="toc-number">8.2.3.4.</span> <span class="toc-text">FileNotFoundError:</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E5%AD%A6%E4%B9%A0"><span class="toc-number">9.</span> <span class="toc-text">案例学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%AA%E4%BA%BA%E5%B7%A5%E8%B5%84%E4%BF%A1%E6%81%AF"><span class="toc-number">9.1.</span> <span class="toc-text">获取个人工资信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%89%8D%E5%8D%81%E8%A1%8C%E7%BB%A9%E6%95%88%E4%BF%A1%E6%81%AF%E8%A1%A8"><span class="toc-number">9.2.</span> <span class="toc-text">生成前十行绩效信息表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B9%B6%E6%89%93%E5%8D%B0%E5%A5%96%E9%87%91%E4%BF%A1%E6%81%AF"><span class="toc-number">9.3.</span> <span class="toc-text">计算并打印奖金信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%96%AA%E8%B5%84%E4%BF%A1%E6%81%AF%E5%AD%97%E5%85%B8"><span class="toc-number">9.4.</span> <span class="toc-text">创建薪资信息字典</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AD%9B%E9%80%89%E5%8C%B9%E9%85%8D"><span class="toc-number">10.</span> <span class="toc-text">筛选匹配</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8C%B9%E9%85%8D"><span class="toc-number">11.</span> <span class="toc-text">数据匹配</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/data.github.io/post/93b2f74a.html" title="mavros"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/29/62939662553c9.png" onerror="this.onerror=null;this.src='/data.github.io/img/404.jpg'" alt="mavros"/></a><div class="content"><a class="title" href="/data.github.io/post/93b2f74a.html" title="mavros">mavros</a><time datetime="2023-08-08T16:00:00.000Z" title="发表于 2023-08-09 00:00:00">2023-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/data.github.io/post/15fa7048.html" title="ROS"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/29/62939662553c9.png" onerror="this.onerror=null;this.src='/data.github.io/img/404.jpg'" alt="ROS"/></a><div class="content"><a class="title" href="/data.github.io/post/15fa7048.html" title="ROS">ROS</a><time datetime="2023-07-28T16:00:00.000Z" title="发表于 2023-07-29 00:00:00">2023-07-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/data.github.io/post/c010a565.html" title="3.c++模板"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/26/628fa0426213d.png" onerror="this.onerror=null;this.src='/data.github.io/img/404.jpg'" alt="3.c++模板"/></a><div class="content"><a class="title" href="/data.github.io/post/c010a565.html" title="3.c++模板">3.c++模板</a><time datetime="2023-07-09T13:03:00.000Z" title="发表于 2023-07-09 21:03:00">2023-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/data.github.io/post/2bc4fa53.html" title="2.c++类2"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/26/628fa0426213d.png" onerror="this.onerror=null;this.src='/data.github.io/img/404.jpg'" alt="2.c++类2"/></a><div class="content"><a class="title" href="/data.github.io/post/2bc4fa53.html" title="2.c++类2">2.c++类2</a><time datetime="2023-07-09T13:02:00.000Z" title="发表于 2023-07-09 21:02:00">2023-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/data.github.io/post/f145b64d.html" title="1.c++类"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/26/628fa0426213d.png" onerror="this.onerror=null;this.src='/data.github.io/img/404.jpg'" alt="1.c++类"/></a><div class="content"><a class="title" href="/data.github.io/post/f145b64d.html" title="1.c++类">1.c++类</a><time datetime="2023-07-09T13:01:00.000Z" title="发表于 2023-07-09 21:01:00">2023-07-09</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://bu.dusays.com/2022/05/29/62939662553c9.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 醉卿枫</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/data.github.io/js/utils.js"></script><script src="/data.github.io/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/data.github.io/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/data.github.io/js/search/local-search.js"></script></div></div></body></html>